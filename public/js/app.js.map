{"version":3,"sources":["app/js/i18next-config.js","app/js/index-auth.js","app/js/init.js","app/js/mante.js","app/js/settings.js","app/js/stats.js"],"names":["settings","require","i18n","jqueryI18next","Backend","default","lngDetector","cache","Url","Cookies","backOpts","service","projectId","apiKey","referenceLng","version","backend","init","currentUrl","laSessionCookie","i18nOpts","fallbackLng","zh","sendMissingTo","interpolation","escapeValue","formatSeparator","format","f","value","lng","toUpperCase","Date","moment","Intl","NumberFormat","whitelist","enabledLangs","load","debug","ns","defaultNS","saveMissing","saveMissingTo","keySeparator","nsSeparator","pluralSeparator","detectorOptions","order","lookupQuerystring","lookupCookie","lookupLocalStorage","cookieMinutes","caches","excludeCacheFor","document","location","host","cookieDomain","mainDomain","cacheOptions","enabled","prefix","expirationTime","versions","detection","sendMissing","missingKeyHandler","miss","key","defaultValue","console","log","on","services","languageDetector","cacheUserLanguage","$","use","err","t","error","language","i18nName","localize","e","preventDefault","lang","data","changeLanguage","query","search","get","in30Minutes","set","expires","jQuery","authCookieName","loginClass","logoutClass","mainDrawerLoginStatusInIndex","origin","mainLAUrl","pathname","isDevel","authCookie","domain","path","removeClass","addClass","checkExist","setInterval","window","length","clearInterval","addEventListener","inMante","manteDiv","html","show","module","exports","baseFooterUrl","collectory","url","title","biocache","biocacheService","bie","bieDis","regions","lists","spatial","images","cas","otherLinks","icon","CountUp","setCounter","id","val","onEnd","options","separator","duration","startVal","Math","round","countUp","start","getStats","callback","indexOf","count","totalRecords","total","getJSON","loadStats"],"mappings":"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","file":"public/js/app.js","sourcesContent":["var settings = require('./settings');\nvar i18n = require('i18next');\nvar jqueryI18next = require('jquery-i18next');\n// var backend = require('i18next-xhr-backend');\nvar Backend = require('i18next-service-backend').default;\nvar lngDetector = require('i18next-browser-languagedetector');\nvar cache = require('i18next-localstorage-cache');\nvar Url = require('domurl');\nvar Cookies = require('js-cookie');\n\n// We use this backend as remote because subdomains.l-a.site should request to l-a.site domain\nconst backOpts = {\n  // service url to the backend service\n  // i.e. https://api.spacetranslate.com or https://api.locize.io\n  service: '$_LOCALES_URL',\n  projectId: '',\n  apiKey: '',\n  referenceLng: 'en',\n  version: 'locales'\n}\nconst backend = new Backend();\nbackend.init(null, backOpts);\n\nvar currentUrl  = new Url;\n\nconst laSessionCookie = 'la-lang-session';\n\nconst i18nOpts = {\n  backend: backOpts,\n  //  lng: 'es',\n  fallbackLng: {\n    zh: ['en'],\n    \"sw-TZ\": ['en'],\n    default: ['en']\n  },\n  sendMissingTo: 'fallback',\n  interpolation: {\n    escapeValue: false,\n    formatSeparator: ',',\n    format: function f(value, format, lng) {\n      // https://www.i18next.com/formatting.html\n      // console.log(`Value: ${value} with format: ${format} to lang: ${lng}`);\n      if (format === 'uppercase') return value.toUpperCase();\n      if (value instanceof Date) return moment(value).format(format);\n      if (format === 'number') return Intl.NumberFormat(lng).format(value);\n      return value;\n    }\n  },\n  whitelist: settings.enabledLangs,\n  load: 'languageOnly', // 'es' o 'en', previously: 'all', // es-ES -> es, en-US -> en\n  debug: true,\n  ns: 'common',\n  defaultNS: 'common',\n  saveMissing: true, // if true seems it's fails to getResourceBundle\n  saveMissingTo: 'en',\n  keySeparator: 'ß',\n  nsSeparator: 'ð',\n  pluralSeparator: 'đ'\n};\n\nconst detectorOptions = {\n  // order and from where user language should be detected\n  order: ['querystring', 'cookie', 'navigator', 'localStorage', 'htmlTag'],\n\n  // keys or params to lookup language from\n  lookupQuerystring: 'lang',\n  lookupCookie: 'i18next',\n  lookupLocalStorage: 'i18nextLng',\n  cookieMinutes: 525600, // a year\n  // cache user language on\n  caches: ['cookie'],\n  excludeCacheFor: ['cimode'] // languages to not persist (cookie, localStorage)\n};\n\nif (document.location.host !== 'localhost:3333') {\n  // We set the upper domain in production so all ALA modules get the same locale\n  detectorOptions.cookieDomain = settings.mainDomain;\n}\n\nconst cacheOptions = {\n  // turn on or off\n  enabled: false,\n  // prefix for stored languages\n  prefix: 'i18next_res_',\n  // expiration\n  expirationTime: 7 * 24 * 60 * 60 * 1000,\n  // language versions\n  versions: {}\n};\n\ni18nOpts.cache = cacheOptions;\ni18nOpts.detection = detectorOptions;\n\ni18nOpts.sendMissing = false;\ni18nOpts.missingKeyHandler = function miss(lng, ns, key, defaultValue) {\n  // call to some API here\n  console.log(`\"${key}\": \"${defaultValue}\"`);\n};\n\ni18n.on('languageChanged', function (lng) {\n  if (i18n.services.languageDetector) {\n    console.log(`On lang changed ${lng}`);\n    // Store in the cookie the selection\n    i18n.services.languageDetector.cacheUserLanguage(lng);\n  }\n});\n\n(function($) {\ni18n.use(backend)\n    .use(lngDetector)\n    .use(cache)\n    .init(i18nOpts, (err, t) => {\n      // initialized and ready to\n      if (err) {\n        console.error(err);\n        return;\n      }\n      console.log(`Language initialized: ${i18n.language}`);\n      jqueryI18next.init(i18n, $, { i18nName: 'i18next' } );\n      console.log('jquery i18next initialized');\n      $(\"body\").localize();\n\n      $('.locale-link').on('click', function(e) {\n        e.preventDefault();\n        const lang = $(this).data('locale');\n        console.log(`Lang clicked ${lang}`);\n\n        i18n.changeLanguage(lang);\n\n        // Change ?lang param and reload\n        currentUrl.query.lang = lang;\n        document.location.search = currentUrl.query;\n      });\n\n      if (typeof Cookies.get(laSessionCookie) === 'undefined' && typeof currentUrl.query.lang === 'undefined') {\n        // Workaround to set grails locale\n        // This will use to do a unique lang redirect (to force grails to set the lang for the session)\n        var in30Minutes = 1/48;\n        // grails default session lifetime is 30min\n        Cookies.set(laSessionCookie, '/', { expires: in30Minutes });\n        currentUrl.query.lang = i18n.language;\n        document.location.search = currentUrl.query;\n      }\n\n      // cookies eu consent\n      /* const cookiesOpt = {\n       *   cookieTitle: t('Uso de Cookies'),\n       *   cookieMessage: t('Utilizamos cookies para asegurar un mejor uso de nuestra web. Si continúas navegando, consideramos que aceptas su uso'),\n       *   showLink: false,\n       *   position: 'bottom',\n       *   linkText: 'Lee más',\n       *   linkRouteName: '/privacy',\n       *   acceptButtonText: t('Aceptar'),\n       *   html: false,\n       *   expirationInDays: 70,\n       *   forceShow: false\n       * };\n       */\n      // CookieConsent.init(cookiesOpt);\n    });\n}(jQuery));\n","var Cookies = require('js-cookie');\nconst settings = require('./settings');\nconst authCookieName = 'ALA-Auth';\nconst loginClass = 'signedIn';\nconst logoutClass = 'signedOut';\n\nvar mainDrawerLoginStatusInIndex = () => {\n  if ((document.location.origin === settings.mainLAUrl || document.location.host === 'localhost:3333') && document.location.pathname === '/' ) {\n    if (settings.isDevel) console.log(\"We are in the main url, let's see if we are authenticated\");\n    // As this page is plain html, we have to detect if with are authenticated via Cookies\n    // NOTE: For make this work you need ala.cookie.httpOnly to false in /data/cas/config/application.yml\n    // We should use another way to see if it's authenticated\n\n    let authCookie = Cookies.get(authCookieName, { domain: settings.mainDomain, path: '/' });\n    var in30Minutes = 1/48;\n\n    if (typeof authCookie === 'undefined' && document.location.host === 'localhost:3333') {\n      console.log(\"We set a test cookie if we are in development\");\n      Cookies.set(authCookieName, '/', { expires: in30Minutes });\n    }\n\n    if (typeof authCookie !== 'undefined') {\n      // https://github.com/AtlasOfLivingAustralia/ala-bootstrap3/blob/master/grails-app/taglib/au/org/ala/bootstrap3/HeaderFooterTagLib.groovy\n      if (settings.isDevel) console.log(\"Auth cookie present so logged in\");\n      $(\"#drawer-nav-menu\").removeClass(\"::loginStatus::\").addClass(\"signedIn\");\n    } else {\n      if (settings.isDevel) console.log(\"No auth cookie not present so not-logged in\");\n      $(\"#drawer-nav-menu\").removeClass(\"::loginStatus:\").addClass(\"signedOut\");\n    }\n  }\n  else {\n    if (settings.isDevel) console.log(\"We aren't in the main url\");\n  }\n};\n\n$(function() {\n  // wait til drawer elements are visible\n  var checkExist = setInterval(function() {\n    if (window.jQuery && $('#drawer-nav-menu').length) {\n      clearInterval(checkExist);\n      mainDrawerLoginStatusInIndex();\n    } else {\n      if (settings.isDevel) console.log(\"drawer not loaded\");\n    }\n  }, 1000);\n});\n","require('./settings.js').default;\nrequire('./index-auth.js');\nrequire('./i18next-config.js');\nrequire('./mante.js');\nrequire('./stats.js');\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('LA skin initialized');\n});\n","var settings = require('./settings');\n\n$(function(){\n  if (settings.inMante) {\n    console.log(\"Setting manteinance banner\");\n\n    var manteDiv = `<div class=\"row\">\n    <div class=\"col-md-6\">\n      <div class=\"error-template\">\n        <h1 data-i18n=\"error.title\"></h1>\n        <h2 data-i18n=\"error.subtitle\"></h2>\n        <div>\n          <p data-i18n=\"error.description\"></p>\n        </div>\n        <div class=\"error-actions\">\n          <a data-i18n=\"error.button\" href=\"${settings.mainLAUrl}\" style=\"margin-top: 10px;\" class=\"btn btn-primary btn-lg\"></a>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-md-6\">\n      <img src=\"images/error.svg\" alt=\"Error Image\" onerror=\"this.onerror=null; this.src='images/error.png'\">\n    </div>\n  </div>`;\n    $(\"#mante-container\").html(manteDiv);\n    $(\"#mante-container\").show();\n  }\n});\n","module.exports = {\n  isDevel: true,\n  inMante: false, // set to true and deploy if you want to set a maintenance message in all the services\n  enabledLangs: ['en', 'es', 'zh', 'sw'],\n  mainDomain: 'l-a.site', // used for cookies (without http/https)\n  mainLAUrl: 'https://l-a.site',\n  baseFooterUrl: 'https://l-a.site',\n  services: {\n    collectory: { url: 'https://collections.l-a.site', title: 'Collections' },\n    biocache: { url: 'https://biocache.l-a.site', title: 'Occurrence records' },\n    biocacheService: { url: 'https://biocache-ws.l-a.site', title: 'Occurrence records webservice' },\n    bie: { url: 'https://especies.gbif.es', title: 'Species' },\n    bieDis: { url: 'https://species.l-a.site', title: 'Species' },\n    regions: { url: 'https://regions.l-a.site', title: 'Regions' },\n    lists: { url: 'https://lists.l-a.site', title: 'Species List' },\n    spatial: { url: 'https://spatial.l-a.site', title: 'Spatial Portal' },\n    images: { url: 'https://images.l-a.site', title: 'Images Service' },\n    cas: { url: 'https://auth.l-a.site', title: 'CAS' }\n  },\n  otherLinks: [\n    { title: 'Datasets', url: 'https://collections.l-a.site/datasets' },\n    { title: 'Explore your area', url: 'http://biocache.l-a.site/explore/your-area/' },\n    { title: 'Datasets', url: 'https://collections.l-a.site/datasets' },\n    { title: 'twitter', url: '', icon: 'twitter' }\n  ]\n}\n","var settings = require('./settings');\n// FIXME var { locale } = require('./i18n_init');\nvar { CountUp } = require('countup.js');\n\nvar collectory = settings.services.collectory.url;\nvar biocacheService = settings.services.biocacheService.url;\n\n\nvar setCounter = (id, val, onEnd) => {\n  const options = {\n    separator: ',', // FIXME  locale === 'en' ? ',': '.',\n    duration: 1\n  };\n  // If testing set some dummy value\n  if (val === 0 && settings.isDevel) {\n    val = 123456;\n  }\n  options.startVal = Math.round(val - val * 4/100); // we increment only a %\n  console.log(`Start val ${options.startVal} to ${val}`);\n  const countUp = new CountUp(id, val, options);\n  if (!countUp.error) {\n    countUp.start(() => { $(`#${id}`).addClass('loaded_stats'); if (typeof onEnd !== 'undefined') onEnd(); });\n  } else {\n    console.error(countUp.error);\n  }\n};\n\nvar getStats = (url, callback) => {\n  if (settings.isDevel) {\n    if (url.indexOf('species') > -1) callback([{ count: 10402 }]);\n    else callback({ totalRecords: 86965283, total: 12922 });\n  } else {\n    // Real call in production\n    $.getJSON(url, callback);\n  }\n}\n\n// If you want to show collections stats:\n// `${collectory}/ws/dataResource/count`\nvar loadStats = () => {\n  getStats(`${biocacheService}/occurrences`, (data) => {\n    setCounter('stats_occurrences', data.totalRecords, () =>\n      getStats(`${collectory}/ws/dataResource/count`, (data) => {\n        setCounter('stats_datasets', data.total, () =>\n          getStats(`${collectory}/ws/institution/count`, (data) => {\n            setCounter('stats_institutions', data.total);\n          })\n        )\n      })\n    )});\n  // Right now this is slow so we put here\n  getStats(`${biocacheService}/occurrence/facets?q=*:*&facets=species&pageSize=0`, (data) => {\n    setCounter(\"stats_species\", data[0].count);\n  });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  if ((document.location.origin === settings.mainLAUrl || document.location.host === 'localhost') && document.location.pathname === '/' ) {\n    // only load stats on /\n    loadStats();\n  }\n});\n"]}